# QueryDaily 백오피스 메뉴 재설계

> 면접 질문 자동화 시스템 도입에 따른 백오피스 메뉴 변경 설계

## 📊 현재 vs 변경 후 비교

### 현재 구조 (수동)

```
QueryDaily 관리
├── 이메일 (activeTab: 'emails')
│   ├── 예정됨 (upcoming)
│   │   └── 질문/답변 수동 등록 후 발송 예약
│   └── 발송 이력 (history)
│       └── 발송된 이메일 목록
├── 구매 (activeTab: 'purchases')
│   ├── 전체
│   ├── TRIAL (무료 체험)
│   ├── GROWTH_PLAN (성장 플랜)
│   ├── REAL_INTERVIEW (실전 면접)
│   ├── CRITICAL_HIT (핵심 면접)
│   ├── LAST_CHECK (마지막 점검)
│   └── RESUME_FIT (이력서 핏)
└── 사용자 (activeTab: 'users')
    └── 신청자 목록 및 담당자 배정
```

### 변경 후 구조 (자동화)

```
QueryDaily 관리
├── 📊 대시보드 (신규)
│   ├── 오늘의 통계
│   │   ├── 발송 예정: N명
│   │   ├── 질문 생성 대기: N명
│   │   └── 관리자 개입 필요: N건
│   ├── 실시간 알림
│   │   └── 품질 검증 실패, AI 생성 실패 등
│   └── 주간 트렌드
│
├── 📧 이메일 발송 (자동화됨)
│   ├── 오늘 발송 (today)
│   │   └── AM 9:00 자동 발송 목록 (읽기 전용)
│   ├── 발송 이력 (history)
│   │   └── 발송 완료/실패 목록
│   └── 수동 발송 (manual) - 긴급 시에만
│       └── 특정 사용자에게 즉시 발송
│
├── 🤖 질문 관리 (신규 - AI 중심)
│   ├── 생성 대기열 (queue)
│   │   └── AI 생성 중 / 품질 검증 중 목록
│   ├── 검토 필요 (review)
│   │   └── 품질 점수 낮은 질문 → 관리자 수정
│   ├── 생성 완료 (generated)
│   │   └── 발송 대기 중인 질문 목록
│   └── 질문 풀 (pool)
│       └── 무료 체험용 공통 질문 관리
│
├── 👥 구매/구독 관리
│   ├── 전체 현황
│   │   └── 상품별 활성 구독 수
│   ├── 무료 체험 (TRIAL)
│   │   ├── 신규 신청 (오늘)
│   │   ├── 진행 중 (Day 1, 2, 3)
│   │   └── 종료 (유료 전환 안내 발송됨)
│   ├── 유료 구매
│   │   ├── GROWTH_PLAN
│   │   ├── REAL_INTERVIEW
│   │   ├── CRITICAL_HIT
│   │   └── ...
│   └── 만료 예정
│       └── 7일 내 만료 목록 (재구매 유도)
│
└── ⚙️ 설정
    ├── AI 설정
    │   ├── 프로바이더 (OpenAI / Ollama)
    │   ├── 품질 임계값 조정
    │   └── 프롬프트 템플릿 편집
    ├── 발송 설정
    │   ├── 발송 시간 (기본 09:00)
    │   └── 재시도 정책
    └── 알림 설정
        └── Slack/Discord 웹훅
```

---

## 🔄 탭 구조 변경

### 기존 `activeTab`

```typescript
const [activeTab, setActiveTab] = useState<'users' | 'emails' | 'purchases'>('emails');
```

### 변경 후 `activeTab`

```typescript
const [activeTab, setActiveTab] = useState<
  | 'dashboard'      // 신규: 대시보드
  | 'emails'         // 기존: 이메일 (자동화됨)
  | 'questions'      // 신규: AI 질문 관리
  | 'subscriptions'  // 기존 purchases → subscriptions
  | 'settings'       // 신규: AI/발송 설정
>('dashboard');
```

### 기존 서브탭 변경

```typescript
// 이메일 서브탭 변경
const [emailsTab, setEmailsTab] = useState<
  | 'today'    // 오늘 발송 예정 (읽기 전용)
  | 'history'  // 발송 이력
  | 'manual'   // 수동 발송 (긴급)
>('today');

// 질문 관리 서브탭 (신규)
const [questionsTab, setQuestionsTab] = useState<
  | 'queue'      // AI 생성 대기열
  | 'review'     // 검토 필요 (품질 미달)
  | 'generated'  // 생성 완료
  | 'pool'       // 공통 질문 풀
>('queue');

// 구독 관리 서브탭
const [subscriptionsTab, setSubscriptionsTab] = useState<
  | 'overview'   // 전체 현황
  | 'trial'      // 무료 체험
  | 'paid'       // 유료 구매
  | 'expiring'   // 만료 예정
>('overview');
```

---

## 📱 UI 변경 상세

### 1. 대시보드 (신규)

```
┌─────────────────────────────────────────────────────────────────┐
│  📊 QueryDaily 대시보드                            [새로고침]    │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐          │
│  │  오늘 발송   │  │  생성 대기   │  │ ⚠️ 개입 필요 │          │
│  │     23명     │  │     5명      │  │     2건      │          │
│  │  ✅ 정상     │  │  🔄 진행중   │  │  🔴 긴급     │          │
│  └──────────────┘  └──────────────┘  └──────────────┘          │
│                                                                 │
│  ┌─ 실시간 알림 ─────────────────────────────────────────────┐  │
│  │ 🔴 14:32 품질 검증 실패 - 김철수 (3차 재시도)             │  │
│  │ 🟡 14:28 AI 응답 지연 - 평균 응답시간 초과 (45s)          │  │
│  │ 🟢 14:25 질문 생성 완료 - 이영희 외 3명                   │  │
│  └───────────────────────────────────────────────────────────┘  │
│                                                                 │
│  ┌─ 주간 통계 ───────────────────────────────────────────────┐  │
│  │  [그래프: 일별 발송 수, 생성 성공률, 품질 점수]           │  │
│  └───────────────────────────────────────────────────────────┘  │
└─────────────────────────────────────────────────────────────────┘
```

### 2. 이메일 발송 (자동화)

```
┌─────────────────────────────────────────────────────────────────┐
│  📧 이메일 발송                                                 │
├─────────────────────────────────────────────────────────────────┤
│  [오늘 발송]  [발송 이력]  [수동 발송]                          │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  📅 2025-12-15 (월) 발송 예정 - 23명                           │
│  ⏰ 예정 시간: 09:00 KST                                        │
│  🔄 상태: 대기 중 (발송까지 18시간 32분)                        │
│                                                                 │
│  ┌────────┬──────────────┬────────────┬──────────┬────────────┐ │
│  │ 이름   │ 이메일       │ 상품       │ Day      │ 질문 상태  │ │
│  ├────────┼──────────────┼────────────┼──────────┼────────────┤ │
│  │ 김철수 │ kim@test.com │ TRIAL      │ 2/3      │ ✅ 준비됨  │ │
│  │ 이영희 │ lee@test.com │ GROWTH     │ 5/15     │ ✅ 준비됨  │ │
│  │ 박지민 │ park@test.com│ TRIAL      │ 1/3      │ 🔄 생성중  │ │
│  │ 최수현 │ choi@test.com│ CRITICAL   │ 3/7      │ ⚠️ 검토    │ │
│  └────────┴──────────────┴────────────┴──────────┴────────────┘ │
│                                                                 │
│  💡 "⚠️ 검토" 상태는 [질문 관리 > 검토 필요]에서 확인하세요    │
└─────────────────────────────────────────────────────────────────┘
```

### 3. 질문 관리 (신규)

```
┌─────────────────────────────────────────────────────────────────┐
│  🤖 질문 관리                                                   │
├─────────────────────────────────────────────────────────────────┤
│  [생성 대기열]  [⚠️ 검토 필요 (2)]  [생성 완료]  [질문 풀]      │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ⚠️ 검토 필요 - 품질 점수 미달 또는 AI 생성 실패               │
│                                                                 │
│  ┌─────────────────────────────────────────────────────────────┐│
│  │ 📋 김철수 - GROWTH_PLAN Day 5                               ││
│  │ ─────────────────────────────────────────────────────────── ││
│  │ 품질 점수: 0.68 (임계값: 0.75)                              ││
│  │ 실패 사유: 중복 질문 탐지 (기존 Day 2 질문과 78% 유사)      ││
│  │                                                             ││
│  │ [미리보기]  [수정]  [재생성 요청]  [수동 등록]              ││
│  └─────────────────────────────────────────────────────────────┘│
│                                                                 │
│  ┌─────────────────────────────────────────────────────────────┐│
│  │ 📋 최수현 - CRITICAL_HIT Day 3                              ││
│  │ ─────────────────────────────────────────────────────────── ││
│  │ 품질 점수: 0.52                                             ││
│  │ 실패 사유: AI 응답 파싱 실패 (JSON 형식 오류)               ││
│  │                                                             ││
│  │ [미리보기]  [수정]  [재생성 요청]  [수동 등록]              ││
│  └─────────────────────────────────────────────────────────────┘│
└─────────────────────────────────────────────────────────────────┘
```

### 4. 질문 풀 관리 (무료 체험용)

```
┌─────────────────────────────────────────────────────────────────┐
│  📚 질문 풀 (무료 체험용 공통 질문)                             │
├─────────────────────────────────────────────────────────────────┤
│  [+ 질문 추가]  카테고리: [전체 ▼]  경력: [전체 ▼]  [검색]     │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ┌────────────────┬──────────┬────────┬───────────┬──────────┐ │
│  │ 카테고리       │ 경력     │ 사용횟수│ 품질점수  │ 액션     │ │
│  ├────────────────┼──────────┼────────┼───────────┼──────────┤ │
│  │ SQL_MASTER     │ JUNIOR   │ 42     │ 0.92      │ [편집]   │ │
│  │ SYSTEM_DESIGN  │ MID      │ 38     │ 0.88      │ [편집]   │ │
│  │ BACKEND_DEEP   │ SENIOR   │ 27     │ 0.95      │ [편집]   │ │
│  │ ...            │          │        │           │          │ │
│  └────────────────┴──────────┴────────┴───────────┴──────────┘ │
│                                                                 │
│  💡 사용횟수가 높은 질문은 다양성을 위해 새 질문 추가를 권장    │
└─────────────────────────────────────────────────────────────────┘
```

---

## 🗂️ 메뉴 역할 변경 요약

| 기존 메뉴 | 변경 후 | 역할 변경 |
|----------|---------|----------|
| 사용자 (users) | **제거** | → 구독 관리로 통합 |
| 이메일 (emails) | 이메일 발송 | 수동 등록 → **읽기 전용** (자동 발송) |
| 구매 (purchases) | 구독 관리 | 이름만 변경 + 만료 예정 추가 |
| - | **대시보드 (신규)** | 전체 현황 + 실시간 알림 |
| - | **질문 관리 (신규)** | AI 생성 모니터링 + 수동 개입 |
| - | **설정 (신규)** | AI/발송/알림 설정 |

---

## 📋 API 변경 사항

### 기존 API
```
POST /api/query-daily/admin/questions     # 질문 수동 등록
POST /api/query-daily/admin/answers       # 답변 수동 등록
POST /api/query-daily/admin/send-email    # 이메일 수동 발송
```

### 추가 API (자동화)
```
# 대시보드
GET  /api/query-daily/admin/dashboard/stats        # 오늘 통계
GET  /api/query-daily/admin/dashboard/alerts       # 실시간 알림
GET  /api/query-daily/admin/dashboard/weekly       # 주간 트렌드

# 질문 관리
GET  /api/query-daily/admin/questions/queue        # 생성 대기열
GET  /api/query-daily/admin/questions/review       # 검토 필요 목록
POST /api/query-daily/admin/questions/:id/regenerate  # 재생성 요청
POST /api/query-daily/admin/questions/:id/approve  # 수동 승인
PUT  /api/query-daily/admin/questions/:id          # 질문 수정

# 질문 풀
GET  /api/query-daily/admin/question-pool          # 공통 질문 목록
POST /api/query-daily/admin/question-pool          # 공통 질문 추가
PUT  /api/query-daily/admin/question-pool/:id      # 공통 질문 수정

# 설정
GET  /api/query-daily/admin/settings               # 현재 설정
PUT  /api/query-daily/admin/settings/ai            # AI 설정 변경
PUT  /api/query-daily/admin/settings/scheduler     # 발송 설정 변경
```

---

## 🚀 구현 우선순위

### Phase 1: 핵심 기능 (1주)
1. **대시보드** - 오늘 통계, 알림
2. **질문 관리 > 검토 필요** - 품질 미달 질문 처리
3. **이메일 발송 > 오늘 발송** - 자동 발송 목록 읽기

### Phase 2: 모니터링 강화 (1주)
4. **질문 관리 > 생성 대기열** - AI 생성 진행 상황
5. **대시보드 > 주간 트렌드** - 통계 그래프
6. **설정 > AI 설정** - 프로바이더/임계값 조정

### Phase 3: 운영 편의 (1주)
7. **질문 풀 관리** - 무료 체험용 공통 질문
8. **구독 관리 > 만료 예정** - 재구매 유도
9. **설정 > 알림** - Slack/Discord 연동

---

**작성일**: 2025-12-15
**작성자**: Claude Code Assistant
**버전**: 1.0
